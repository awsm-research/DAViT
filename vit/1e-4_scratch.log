08/28/2024 11:51:30 - WARNING - __main__ -   device: cuda, n_gpu: 2
Fast image processor class <class 'transformers.models.vit.image_processing_vit_fast.ViTImageProcessorFast'> is available for this model. Using slow image processor class. To use the fast image processor class set `use_fast=True`.
08/28/2024 11:51:32 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../data/chest_xray/train', eval_data_file='../data/chest_xray/val', test_data_file='../data/chest_xray/test', pretrain_language='', output_dir='./saved_models', model_type='roberta', encoder_block_size=512, max_line_length=64, model_name='1e-4_scratch.bin', checkpoint_model_name='non_domain_model.bin', model_name_or_path='google/vit-base-patch16-224', config_name='', feature_processor_name='', do_train=False, do_test=True, evaluate_during_training=True, train_batch_size=128, eval_batch_size=128, gradient_accumulation_steps=1, learning_rate=0.0001, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=123456, epochs=100, use_original_data=False, n_gpu=2, device='cuda')
  0%|          | 0/624 [00:00<?, ?it/s]  3%|▎         | 17/624 [00:00<00:03, 159.66it/s]  6%|▌         | 35/624 [00:00<00:03, 167.59it/s]  9%|▊         | 54/624 [00:00<00:03, 176.18it/s] 12%|█▏        | 72/624 [00:00<00:03, 167.03it/s] 14%|█▍        | 89/624 [00:00<00:03, 163.01it/s] 17%|█▋        | 108/624 [00:00<00:03, 168.95it/s] 20%|██        | 125/624 [00:00<00:03, 161.64it/s] 23%|██▎       | 142/624 [00:00<00:02, 161.18it/s] 26%|██▌       | 162/624 [00:00<00:02, 169.06it/s] 29%|██▊       | 179/624 [00:01<00:02, 165.05it/s] 31%|███▏      | 196/624 [00:01<00:02, 164.90it/s] 34%|███▍      | 214/624 [00:01<00:02, 168.36it/s] 37%|███▋      | 232/624 [00:01<00:02, 170.87it/s] 41%|████      | 253/624 [00:01<00:02, 181.28it/s] 44%|████▎     | 272/624 [00:01<00:01, 181.31it/s] 47%|████▋     | 291/624 [00:01<00:02, 159.38it/s] 49%|████▉     | 308/624 [00:01<00:01, 161.35it/s] 52%|█████▏    | 326/624 [00:01<00:01, 165.41it/s] 55%|█████▍    | 343/624 [00:02<00:01, 160.99it/s] 58%|█████▊    | 360/624 [00:02<00:01, 153.01it/s] 60%|██████    | 376/624 [00:02<00:01, 147.30it/s] 63%|██████▎   | 391/624 [00:02<00:01, 146.51it/s] 66%|██████▌   | 409/624 [00:02<00:01, 154.38it/s] 69%|██████▊   | 428/624 [00:02<00:01, 162.95it/s] 72%|███████▏  | 448/624 [00:02<00:01, 170.70it/s] 75%|███████▍  | 466/624 [00:02<00:00, 172.73it/s] 78%|███████▊  | 486/624 [00:02<00:00, 180.23it/s] 81%|████████  | 505/624 [00:03<00:00, 167.51it/s] 84%|████████▎ | 522/624 [00:03<00:00, 167.88it/s] 86%|████████▋ | 539/624 [00:03<00:00, 159.26it/s] 89%|████████▉ | 556/624 [00:03<00:00, 152.13it/s] 92%|█████████▏| 575/624 [00:03<00:00, 160.66it/s] 95%|█████████▌| 593/624 [00:03<00:00, 165.70it/s] 98%|█████████▊| 611/624 [00:03<00:00, 168.55it/s]100%|██████████| 624/624 [00:03<00:00, 163.41it/s]
08/28/2024 11:51:40 - INFO - __main__ -   ***** Running evaluation *****
08/28/2024 11:51:40 - INFO - __main__ -     Num examples = 624
08/28/2024 11:51:40 - INFO - __main__ -     Batch size = 128
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:00<00:03,  1.28it/s] 40%|████      | 2/5 [00:00<00:01,  2.29it/s] 60%|██████    | 3/5 [00:01<00:00,  3.05it/s] 80%|████████  | 4/5 [00:01<00:00,  3.62it/s]100%|██████████| 5/5 [00:01<00:00,  4.12it/s]100%|██████████| 5/5 [00:01<00:00,  3.21it/s]
08/28/2024 11:51:42 - INFO - __main__ -   ***** Test results *****
08/28/2024 11:51:42 - INFO - __main__ -   f1: 0.7103658536585366
08/28/2024 11:51:42 - INFO - __main__ -   precision: 0.8759398496240601
08/28/2024 11:51:42 - INFO - __main__ -   recall: 0.5974358974358974
08/28/2024 11:51:42 - INFO - __main__ -   specificity: 0.8589743589743589
08/28/2024 11:51:42 - INFO - __main__ -   Acc: 0.6955128205128205
08/28/2024 11:51:42 - INFO - __main__ -   AUC: 0.7282051282051284
