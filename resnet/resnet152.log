09/03/2024 21:36:36 - WARNING - __main__ -   device: cuda, n_gpu: 2
/home/michael/.local/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/michael/.local/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet152_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet152_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
09/03/2024 21:36:36 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../data/chest_xray/train', eval_data_file='../data/chest_xray/val', test_data_file='../data/chest_xray/test', pretrain_language='', output_dir='./saved_models', model_type='roberta', encoder_block_size=512, max_line_length=64, model_name='resnet.bin', checkpoint_model_name='non_domain_model.bin', model_name_or_path=None, config_name='', feature_processor_name='', do_train=False, do_test=True, evaluate_during_training=True, train_batch_size=128, eval_batch_size=128, gradient_accumulation_steps=1, learning_rate=0.001, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=123456, epochs=100, use_original_data=False, n_gpu=2, device='cuda')
  0%|          | 0/624 [00:00<?, ?it/s]  2%|▏         | 13/624 [00:00<00:04, 128.87it/s]  4%|▍         | 26/624 [00:00<00:04, 127.61it/s]  6%|▋         | 40/624 [00:00<00:04, 131.77it/s]  9%|▉         | 57/624 [00:00<00:03, 143.75it/s] 12%|█▏        | 72/624 [00:00<00:03, 141.31it/s] 14%|█▍        | 87/624 [00:00<00:03, 140.53it/s] 17%|█▋        | 105/624 [00:00<00:03, 152.02it/s] 19%|█▉        | 121/624 [00:00<00:03, 144.36it/s] 22%|██▏       | 136/624 [00:00<00:03, 141.05it/s] 25%|██▍       | 153/624 [00:01<00:03, 148.00it/s] 27%|██▋       | 168/624 [00:01<00:03, 146.16it/s] 30%|██▉       | 185/624 [00:01<00:02, 151.91it/s] 32%|███▏      | 201/624 [00:01<00:02, 143.49it/s] 35%|███▌      | 220/624 [00:01<00:02, 153.06it/s] 38%|███▊      | 237/624 [00:01<00:02, 156.83it/s] 41%|████      | 254/624 [00:01<00:02, 158.76it/s] 43%|████▎     | 271/624 [00:01<00:02, 161.95it/s] 46%|████▌     | 288/624 [00:01<00:02, 146.16it/s] 49%|████▊     | 303/624 [00:02<00:02, 145.03it/s] 51%|█████     | 318/624 [00:02<00:02, 144.40it/s] 54%|█████▎    | 335/624 [00:02<00:01, 148.80it/s] 56%|█████▋    | 351/624 [00:02<00:01, 142.67it/s] 59%|█████▊    | 366/624 [00:02<00:01, 133.91it/s] 61%|██████    | 380/624 [00:02<00:01, 132.92it/s] 63%|██████▎   | 396/624 [00:02<00:01, 140.02it/s] 66%|██████▌   | 413/624 [00:02<00:01, 147.08it/s] 69%|██████▊   | 428/624 [00:02<00:01, 146.46it/s] 71%|███████▏  | 446/624 [00:03<00:01, 155.84it/s] 74%|███████▍  | 462/624 [00:03<00:01, 156.05it/s] 77%|███████▋  | 479/624 [00:03<00:00, 159.06it/s] 79%|███████▉  | 495/624 [00:03<00:00, 149.87it/s] 82%|████████▏ | 511/624 [00:03<00:00, 146.48it/s] 84%|████████▍ | 526/624 [00:03<00:00, 147.27it/s] 87%|████████▋ | 542/624 [00:03<00:00, 146.27it/s] 89%|████████▉ | 557/624 [00:03<00:00, 141.33it/s] 92%|█████████▏| 573/624 [00:03<00:00, 145.55it/s] 95%|█████████▍| 591/624 [00:04<00:00, 149.93it/s] 97%|█████████▋| 607/624 [00:04<00:00, 152.70it/s]100%|█████████▉| 623/624 [00:04<00:00, 139.59it/s]100%|██████████| 624/624 [00:04<00:00, 146.15it/s]
09/03/2024 21:36:55 - INFO - __main__ -   ***** Running evaluation *****
09/03/2024 21:36:55 - INFO - __main__ -     Num examples = 624
09/03/2024 21:36:55 - INFO - __main__ -     Batch size = 128
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:00<00:03,  1.15it/s] 40%|████      | 2/5 [00:01<00:01,  2.22it/s] 60%|██████    | 3/5 [00:01<00:00,  3.20it/s] 80%|████████  | 4/5 [00:01<00:00,  4.04it/s]100%|██████████| 5/5 [00:01<00:00,  3.91it/s]100%|██████████| 5/5 [00:01<00:00,  3.14it/s]
09/03/2024 21:36:56 - INFO - __main__ -   ***** Test results *****
09/03/2024 21:36:56 - INFO - __main__ -   f1: 0.945273631840796
09/03/2024 21:36:56 - INFO - __main__ -   precision: 0.9178743961352657
09/03/2024 21:36:56 - INFO - __main__ -   recall: 0.9743589743589743
09/03/2024 21:36:56 - INFO - __main__ -   specificity: 0.8547008547008547
09/03/2024 21:36:56 - INFO - __main__ -   Acc: 0.9294871794871795
09/03/2024 21:36:56 - INFO - __main__ -   AUC: 0.9145299145299145
